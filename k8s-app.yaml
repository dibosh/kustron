name: my-service
namespace: ns-myservice

port: 8080
healthCheck: /health
autoScaling:
  min: 2
  max: 10
resourcePerInstance:
  cpu: 0.5 # cpu it requests for
  memory: 512 # memory it requests for in MB
# common env vars
env:
  MAX_RETRIES: 5
  SECRET_VAL: secrets.SECRET_NAME

targets:
  - name: dev
    expose:
      ipName: my-service-dev-ip
      cert: secrets.CERT_NAME
      # or
      # gatewayName: existing-istio-gateway
      path: /my-service # or if no path is provided then '/' is used
    env:
      MAX_RETRIES: 5
      SECRET_VAL: secrets.SECRET_NAME
  - name: stg
    expose:
      ipName: my-service-dev-ip
      cert: secrets.CERT_NAME
      attachToGateway:
        name: existing-istio-gateway
        path: /my-service
    env:
      MAX_RETRIES: 9
      SECRET_VAL: secrets.SECRET_NAME

